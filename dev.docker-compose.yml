---
version: "3.8"

services:
  server:
    build:
      target: build
      cache_from:
        - ghcr.io/${REPOSITORY:-dev-hato/hato-atama}/server-dev:${TAG_NAME}
        - ghcr.io/${REPOSITORY:-dev-hato/hato-atama}/server-dev
    image: ghcr.io/${REPOSITORY:-dev-hato/hato-atama}/server-dev:${TAG_NAME}
    volumes:
      - ./server:/go/app/server

  frontend:
    build:
      target: build
      cache_from:
        - ghcr.io/${REPOSITORY:-dev-hato/hato-atama}/frontend-dev:${TAG_NAME}
        - ghcr.io/${REPOSITORY:-dev-hato/hato-atama}/frontend-dev
    image: ghcr.io/${REPOSITORY:-dev-hato/hato-atama}/frontend-dev:${TAG_NAME}
    volumes:
      - ./frontend/src:/usr/src/app/src
